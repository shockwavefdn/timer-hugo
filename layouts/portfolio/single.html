{{ define "main" }}

<main id="main-content" class="work-single">
    {{ partial "page-title.html" . }}

    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                {{ if .Params.image }}
                  {{ $original := .Page.Resources.GetMatch (printf "*%s*" .Params.image) }}
                  {{ if $original }}
                    {{ $image := $original.Resize "730x" }}
                    <div class="work-single-image" data-aos="fade-top" data-aos-delay="300">
                      <figure class="figure">
                        <img class="figure-img img-fluid w-100" src="{{ $image.Permalink }}"
                             width="{{ $image.Width }}" height="{{ $image.Height }}"
                             alt="{{ with .Params.imageAlt }}{{ . }}{{ end }}">
                         <figcaption class="figure-caption text-right">
                           {{ with .Params.imageCaption }}
                             {{ . | markdownify }}
                           {{ else }}
                             image courtesy {{ .Params.client.name }}
                           {{ end }}
                         </figcaption>
                       </figure>
                    </div>
                  {{ else }}
                    {{ errorf "%s: %s not found. (layouts/portfolio/single.html)" .File.Path .Params.image }}
                  {{ end }}
                {{ else }}
                  {{ warnf "%s: image not set. (layouts/portfolio/single.html)" .File.Path }}
                {{ end }}
                <article data-aos="fade-left" data-aos-delay="300">
                  <h2>{{ .Title }}</h2>
                  <div class="work-single-content block">
                    {{ .Content }}
                  </div>
                  <footer class="post-date">
                    Last updated:
                    <time datetime="{{ dateFormat $.Site.Params.rfc3339Format .Date }}">{{ dateFormat ($.Site.Params.dateFormat | default "2 January 2006") .Date }}</time>
                  </footer>
                  {{ partial "related.html" . }}
                </article>
            </div>
            <!-- sidebar -->
            <aside class="col-lg-4">
                {{ with .Params.client }}
                <div class="work-single-sidebar block" data-aos="fade-right" data-aos-delay="300">
                  {{ if isset . "logo" }}
                    {{ $logo := $.Page.Resources.GetMatch (printf "*%s*" .logo) }}
                    {{ if $logo }}
                      {{ with .website }}<a href="{{ . }}" target="_blank">{{ end }}
                        <img class="img-fluid mx-auto d-block p-3" src="{{ $logo.Permalink }}" alt="{{ .name }} logo">
                      {{ with .website }}</a>{{ end }}
                    {{ else }}
                      {{ errorf "%s: %s: Not found" $.File.Path .logo }}
                    {{ end }}
                  {{ end }}
                  <dl>
                    {{ with .name }}
                    <dt>Organization</dt>
                    <dd>{{ . }}</dd>
                    {{ end }}
                    {{ with .website }}
                    <dt>Website</dt>
                    <dd><a href="{{ . }}" target="_blank">{{ . }}</a></dd>
                    {{ end }}
                    {{ with $.Params.categories }}
                    <dt>Categories</dt>
                    <dd>{{ delimit . ", " }}</dd>
                    {{ end }}
                    {{ with $.Params.tags }}
                    <dt>Tags</dt>
                    <dd>{{ delimit . ", " }}</dd>
                    {{ end }}
                    {{ with .beneficiaries }}
                    <dt>Beneficiaries</dt>
                    <dd>{{ delimit . ", " }}</dd>
                    {{ end }}
                    {{ with .locations }}
                    <dt>Location(s)</dt>
                    <dd>{{ delimit . ", " }}</dd>
                    {{ end }}
                  </dl>
                  {{ range sort .awards "dateAwarded" "desc" }}
                    <hr>
                    <dl>
                    {{ with .dateSubmitted }}
                      <dt>Date Submitted</dt>
                      <dd><time datetime="{{ dateFormat $.Site.Params.rfc3339Format . }}">{{ dateFormat ($.Site.Params.monthFormat | default "January 2006") . }}</time></dd>
                    {{ end }}
                    {{ with .dateAwarded }}
                      <dt>Date Awarded</dt>
                      <dd><time datetime="{{ dateFormat $.Site.Params.rfc3339Format . }}">{{ dateFormat ($.Site.Params.monthFormat | default "January 2006") . }}</time></dd>
                    {{ end }}
                    {{ with .requested }}
                      <dt>Requested</dt>
                      <dd>${{ lang.NumFmt 0 . }}</dd>
                    {{ end }}
                    {{ with .awarded }}
                      <dt>Awarded</dt>
                      <dd>${{ lang.NumFmt 0 . }}</dd>
                    {{ end }}
                    {{ with .invested }}
                      <dt>Invested</dt>
                      <dd>${{ lang.NumFmt 0 . }}</dd>
                    {{ end }}
                    {{ with .distributed }}
                      <dt>Distributed</dt>
                      <dd>${{ lang.NumFmt 0 . }}</dd>
                    {{ end }}
                    {{ with .duration }}
                      <dt>Project Duration</dt>
                      <dd>{{ . }}</dd>
                    {{ end }}
                    </dl>
                  {{ end }}
                </div>
                {{ end }}
              </aside>
        </div>
    </div>
  </main>

{{ partial "cta.html" . }}

{{ end }}
